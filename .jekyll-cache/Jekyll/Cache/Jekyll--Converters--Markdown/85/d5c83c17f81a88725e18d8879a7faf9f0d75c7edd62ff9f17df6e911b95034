I"!Ò<p>äº’è”ç½‘ï¼Œå°†å…¨çƒä¸åŒçš„è®¡ç®—æœºç­‰ç”µå­è®¾å¤‡è¿æ¥èµ·æ¥ï¼Œä½¿å…·å¤‡äº’ç›¸é€šä¿¡çš„æ¡ä»¶ï¼Œä½†æ˜¯é€šä¿¡ä¿¡æ¯æœ‰äº›äº‹éšç§ï¼Œæœ‰äº›é€šä¿¡ä¸èƒ½è¢«å…¶ä»–äººçŸ¥é“ã€‚äº’è”ç½‘ç§äººç”Ÿæ´»äº¤æµä¿¡æ¯ä¸è¢«æ¶æ„è€…éšæ„çªƒå–ï¼Œä¹Ÿåº”è¯¥æ˜¯ç¤¾ä¼šç§©åºæ­£å¸¸ç¨³å®šçš„è¡¨ç°ï¼Œå¹³æ—¶çš„é€šä¿¡ä¸è¿‡å¦‚æ­¤ï¼Œæ¶‰åŠåˆ°å•†ä¸šä¿¡æ¯ï¼Œæ•°æ®ä¿å¯†æ›´æ˜¾å¾—æ ¼å¤–é‡è¦ã€‚åŠ å¯†ç®—æ³•æ˜¯ä¿æŒé€šä¿¡ä¿¡æ¯ä¸æ³„æ¼çš„ä¸€ç§æŠ€æœ¯ï¼Œå¯ç”¨æ‰‹æ®µâ€™â€™</p>

<h1 id="ç½‘ç»œæ•°æ®åŠ å¯†">ç½‘ç»œæ•°æ®åŠ å¯†</h1>

<p>äº’è”ç½‘ï¼Œå°†å…¨çƒä¸åŒçš„è®¡ç®—æœºç­‰ç”µå­è®¾å¤‡è¿æ¥èµ·æ¥ï¼Œä½¿å…·å¤‡äº’ç›¸é€šä¿¡çš„æ¡ä»¶ï¼Œä½†æ˜¯é€šä¿¡ä¿¡æ¯æœ‰äº›äº‹éšç§ï¼Œæœ‰äº›é€šä¿¡ä¸èƒ½è¢«å…¶ä»–äººçŸ¥é“ã€‚äº’è”ç½‘ç§äººç”Ÿæ´»äº¤æµä¿¡æ¯ä¸è¢«æ¶æ„è€…éšæ„çªƒå–ï¼Œä¹Ÿåº”è¯¥æ˜¯ç¤¾ä¼šç§©åºæ­£å¸¸ç¨³å®šçš„è¡¨ç°ï¼Œå¹³æ—¶çš„é€šä¿¡ä¸è¿‡å¦‚æ­¤ï¼Œæ¶‰åŠåˆ°å•†ä¸šä¿¡æ¯ï¼Œæ•°æ®ä¿å¯†æ›´æ˜¾å¾—æ ¼å¤–é‡è¦ã€‚åŠ å¯†ç®—æ³•æ˜¯ä¿æŒé€šä¿¡ä¿¡æ¯ä¸æ³„æ¼çš„ä¸€ç§æŠ€æœ¯ï¼Œå¯ç”¨æ‰‹æ®µã€‚</p>

<h2 id="å‰è¨€">å‰è¨€</h2>

<h3 id="ç½‘ç»œæ•°æ®åŠ å¯†æ˜¯å¿…é¡»åšçš„äº‹">ç½‘ç»œæ•°æ®åŠ å¯†æ˜¯å¿…é¡»åšçš„äº‹</h3>

<h4 id="å®‰å…¨æ­£ç¡®å¿…è¦æ€§">å®‰å…¨æ­£ç¡®å¿…è¦æ€§</h4>

<p>äº’è”ç½‘é€šä¿¡é€šè¿‡ç”µç¼†æˆ–è€…æ— çº¿è®¾å¤‡ï¼Œä¿¡æ¯æ˜¯å¯ä»¥è¢«ä¸­é—´äººæ”¶åˆ°è®°å½•çš„ï¼Œæ‰€ä»¥è¦è€ƒè™‘å¾ˆå¤šé£é™©å› ç´ ï¼Œä¿¡æ¯å¿…é¡»è¢«åŠ å¯†å¤„ç†åªæ˜¯å…¶ä¸­ä¹‹ä¸€çš„è€ƒè™‘</p>

<h5 id="ä¿¡æ¯å®‰å…¨">ä¿¡æ¯å®‰å…¨</h5>

<p>æ˜æ–‡å¯èƒ½è¢«ç¬¬ä¸‰æ–¹åŠ«æŒæŸ¥çœ‹ã€‚</p>

<p>å°±åƒå†™ä¿¡ä¸€æ ·ï¼ŒAå†™ä¿¡ç»™Bï¼Œåœ¨ä¿¡ä»¶åˆ°è¾¾Bæ‰‹ä¸Šä¹‹å‰ï¼Œä¿¡ä»¶åœ¨é€”ä¸­å¯èƒ½è¢«åˆ«äººæ‹†å¼€çœ‹è¿‡ç„¶åå†å°è£…åŸæ ·ï¼Œä½¿ABéƒ½ä¸èƒ½å‘è§‰ä¿¡æ¯å·²ç»è¢«ç¬¬ä¸‰ä¸ªäººçœ‹äº†ã€‚</p>

<h5 id="ä¿¡æ¯æ­£ç¡®">ä¿¡æ¯æ­£ç¡®</h5>

<p>ä¼ è¾“ä¿¡æ¯å¯èƒ½è¢«ä¿®æ”¹</p>

<p>åŒæ ·Aç»™Bå†™ä¿¡ï¼Œåœ¨é€”ä¸­ä¿¡ä»¶è¢«äººåŠ«æŒï¼Œå¦‚æœä¿¡ä»¶é€”ä¸­è¢«åˆ«äººæ‰“å¼€ï¼Œæ›¿æ¢é‡Œé¢çš„ä¿¡æ¯å†…å®¹ï¼ŒBæ”¶åˆ°åçš„ä¿¡æ¯å¾ˆå¯èƒ½æ˜¯é”™è¯¯çš„ã€‚</p>

<p>ç½‘ç»œä¹Ÿæ˜¯ä¸€æ ·ï¼Œç½‘ç»œé€šä¿¡å¿…é¡»é€šè¿‡æœ‰çº¿æˆ–è€…æ— çº¿è®¾å¤‡ä¼ è¾“ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯å¯ä»¥åŠ«æŒçš„ï¼Œæ˜æ–‡é€šä¿¡æ²¡æœ‰éšç§å¯è¨€ï¼Œæä¸å®‰å…¨ï¼Œæ‰€ä»¥åŠ å¯†ç®—æ³•é€šå¸¸éœ€è¦åšçš„äº‹</p>

<h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2>

<blockquote>
  <p>å‚è€ƒæ–‡ç« </p>

  <p>https://www.cnblogs.com/hulianwangjiagoushi/p/10671771.html</p>
</blockquote>

<p>é¦–å…ˆåŠ å¯†æ˜¯å› ä¸ºå­˜åœ¨ç½‘è·¯ä¿¡æ¯ä¼ è¾“ï¼Œæ‰€ä»¥åŠ å¯†çš„ä½¿ç”¨è¿‡ç¨‹åˆ†ä¸‰æ­¥</p>

<p>ä¸¾ä¾‹ Aè®¡ç®—æœºé€šè¿‡ç½‘ç»œä¼ è¾“ä¿¡æ¯ç»™Bè®¡ç®—æœºï¼Œä¸­é—´ä½¿ç”¨åŠ å¯†ç®—æ³•è¿‡ç¨‹å¦‚ä¸‹</p>

<p>A (æ˜æ–‡ â€“&gt;åŠ å¯†â€“&gt;å¯†æ–‡)   â€”â€”â€”â€“ç½‘ç»œï¼ˆå¯†æ–‡ï¼‰â€”â€”â€”â€“&gt; Bï¼ˆå¯†æ–‡ â€“&gt;è§£å¯†â€“&gt;æ˜æ–‡ï¼‰</p>

<pre><code class="language-flow">st=&gt;start: æ˜æ–‡
op1=&gt;operation: Aç«¯åŠ å¯†
op2=&gt;operation: åŠ å¯†å¯†æ–‡ç½‘ç»œä¼ è¾“
cond=&gt;condition: ç­¾åç¡®è®¤ æ˜¯å¦ä¸ºAç«¯å‘é€çš„åŠ å¯†æ•°æ®?
op3=&gt;operation: Bç«¯è§£å¯†
op4=&gt;operation: ä¸¢å¼ƒï¼ˆè¢«ç¯¡æ”¹ï¼‰ä¿¡æ¯
e=&gt;end: æ˜æ–‡
st-&gt;op1-&gt;op2-&gt;cond
op3-&gt;e
cond(yes)-&gt;op3-&gt;e
cond(no)-&gt;op4

#cond=&gt;condition: Yes or No?
#cond(yes)-&gt;e
#cond(no)-&gt;op
</code></pre>
<h5 id="å¯†é’¥">å¯†é’¥</h5>

<p>ç”¨äºåŠ å¯†çš„æ ¹æ®ï¼Œæ˜æ–‡åŠ å¯†æˆå¯†æ–‡çš„å‡­æ®ï¼Œæ ¹æ®å¯†é’¥æœ‰è§„åˆ™çš„åŠ å¯†ï¼Œä¹Ÿåªæœ‰æ ¹æ®å¯†é’¥æ‰èƒ½æœ‰è§„åˆ™çš„è§£å¯†ï¼Œåº”æ­¤é€šä¿¡ä¸­åŠ å¯†çš„å¯†é’¥ä¿ç®¡ä¹Ÿå¾ˆé‡è¦ï¼ˆä¸èƒ½è¢«æ³„éœ²ï¼‰</p>

<h5 id="æ˜æ–‡">æ˜æ–‡</h5>

<p>æ˜æ–‡æŒ‡ä¸¤è€…é€šä¿¡çš„åŸæ–‡ï¼Œèƒ½çœ‹æ‡‚çš„ã€‚</p>

<h5 id="åŠ å¯†">åŠ å¯†</h5>

<p>å°†æ˜æ–‡é€šè¿‡æŸç§æ–¹å¼åŠ å¯†å˜æˆå¯†æ–‡</p>

<h5 id="å¯†æ–‡">å¯†æ–‡</h5>

<p>å°†æ˜æ–‡åŠ å¯†åçš„ä¿¡æ¯ï¼Œå¹¶ä¸”é™¤äº†å¯†é’¥ï¼Œä¸èƒ½ç”¨å…¶ä»–æ–¹å¼å°†å…¶è§£å¯†æˆåŸæ–‡ä¿¡æ¯</p>

<h5 id="ä¼ è¾“">ä¼ è¾“</h5>

<p>å¯†æ–‡çš„ä¼ è¾“ï¼ˆä¸æ€•åˆ«äººçœ‹åˆ°å¯†æ–‡ï¼Œå¯†æ–‡çœ‹ä¸åˆ°çœŸå®ä¿¡æ¯ï¼Œç¬¬ä¸‰æ–¹ä¸èƒ½è·å–æœ‰æ•ˆä¿¡æ¯ï¼‰</p>

<h5 id="è§£å¯†">è§£å¯†</h5>

<p>å°†å¯†æ–‡è¿˜åŸæˆæ˜æ–‡ï¼ˆæ¥æ”¶è€…èƒ½çœ‹åˆ°æ˜æ–‡ï¼‰</p>

<h5 id="ç­¾å">ç­¾å</h5>

<p>ä¿è¯åŒæ–¹çš„ä¿¡æ¯çœŸå®æ²¡è¢«ä¿®æ”¹çš„æŠ€æœ¯</p>

<p>Aä¸Bä¹‹é—´è¦æœ‰ä¸€ç§ç­¾åå­˜åœ¨ï¼Œåœ¨é€šä¿¡çš„æ—¶å€™ï¼Œæ”¶åˆ°ä¿¡æ¯ï¼Œé€šè¿‡ç­¾åè¦èƒ½é‰´åˆ«ä¿¡æ¯æ˜¯å¦è¢«ç¬¬ä¸‰æ–¹ä¿®æ”¹æˆ–è€…ä¿¡æ¯æ˜¯ç¬¬ä¸‰æ–¹ä¼ªé€ å‘é€ã€‚</p>

<h1 id="åŠ å¯†ç®—æ³•">åŠ å¯†ç®—æ³•</h1>

<p>ä¿¡æ¯åŠ å¯†æ˜¯éå¸¸ä¸“ä¸šçš„è®¡ç®—çŸ¥è¯†ï¼Œé€šè¿‡å¤æ‚è®¾è®¡ï¼Œå¯¹ä¿¡æ¯æ•°æ®åŠ å¯†ï¼Œä½¿ä¸èƒ½è¢«è½»æ˜“ç ´è§£ã€‚å¸¸è§çš„åŠ å¯†ç®—æ³•éƒ½éœ€è¦æœ‰å¯†é’¥ï¼Œé€šè¿‡å¯†é’¥åˆ†ç±»åˆå¯ä»¥åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚</p>

<p>å¯¹ç§°åŠ å¯†æŒ‡ä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼Œéå¯¹ç§°åŠ å¯†åˆ™æ˜¯ä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ä¸æ˜¯ç”¨åˆ°åŒä¸€ä¸ªå¯†é’¥</p>

<h2 id="å¯¹ç§°åŠ å¯†">å¯¹ç§°åŠ å¯†</h2>

<h3 id="aes">AES</h3>

<blockquote>
  <p>å¯†ç å­¦ä¸­çš„é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAdvanced Encryption Standardï¼ŒAESï¼‰</p>

  <p>è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„<a href="https://baike.baidu.com/item/DES">DES</a>ï¼ˆData Encryption Standardï¼‰ï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚ç»è¿‡äº”å¹´çš„ç”„é€‰æµç¨‹ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ ï¼ˆNISTï¼‰äº2001å¹´11æœˆ26æ—¥å‘å¸ƒäºFIPS PUB 197ï¼Œå¹¶åœ¨2002å¹´5æœˆ26æ—¥æˆä¸ºæœ‰æ•ˆçš„æ ‡å‡†ã€‚2006å¹´ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†å·²ç„¶æˆä¸ºå¯¹ç§°å¯†é’¥åŠ å¯†ä¸­æœ€æµè¡Œçš„ç®—æ³•ä¹‹ä¸€ [1] ã€‚</p>

  <p>è¯¥ç®—æ³•ä¸ºæ¯”åˆ©æ—¶å¯†ç å­¦å®¶Joan Daemenå’ŒVincent Rijmenæ‰€è®¾è®¡ï¼Œç»“åˆä¸¤ä½ä½œè€…çš„åå­—ï¼Œä»¥Rijdaelä¹‹åå‘½ä¹‹ï¼ŒæŠ•ç¨¿é«˜çº§åŠ å¯†æ ‡å‡†çš„ç”„é€‰æµç¨‹ã€‚ï¼ˆRijdaelçš„å‘éŸ³è¿‘äº â€œRhine dollâ€ã€‚ï¼‰</p>
</blockquote>

<h4 id="åŸç†">åŸç†</h4>

<blockquote>
  <p>AESåŠ å¯†æ•°æ®å—å’Œå¯†é’¥é•¿åº¦å¯ä»¥æ˜¯128bã€192bã€256bä¸­çš„ä»»æ„ä¸€ä¸ªã€‚AESåŠ å¯†æœ‰å¾ˆå¤šè½®çš„é‡å¤å’Œå˜æ¢ã€‚å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼šâ‘ å¯†é’¥æ‰©å±•ï¼ˆKey Expansion)ï¼›â‘¡åˆå§‹è½®ï¼ˆInitialRound)ï¼›â‘¢é‡å¤è½®ï¼ˆRoundsï¼‰ï¼Œæ¯ä¸€é‡å¤è½®åˆåŒ…æ‹¬å­—èŠ‚é—´å‡æ³•è¿ç®—ï¼ˆSubBytesï¼‰ã€è¡Œç§»ä½ï¼ˆShiftRowsï¼‰ã€åˆ—æ··åˆï¼ˆMixColumns)ã€è½®å¯†é’¥åŠ æ³•è¿ç®—ï¼ˆAddRoundKey)ç­‰æ“ä½œï¼›â‘ æœ€ç»ˆè½®ï¼ˆFinal Round)ï¼Œæœ€ç»ˆè½®æ²¡æœ‰åˆ—æ··åˆæ“ä½œï¼ˆMixColumns)ã€‚</p>
</blockquote>

<h5 id="ç›¸å…³æ–‡ç« ä»‹ç»">ç›¸å…³æ–‡ç« ä»‹ç»ï¼š</h5>

<p>https://blog.csdn.net/zxh2075/article/details/80630296</p>

<p>https://www.jianshu.com/p/79a225c2650e</p>

<p>https://blog.csdn.net/huangxiaoguo1/article/details/78043169</p>

<h4 id="åŠ å¯†è¿‡ç¨‹">åŠ å¯†è¿‡ç¨‹</h4>

<p>128ä½å¯†é’¥åŠ å¯†æµç¨‹ç®€ç•¥æè¿°ï¼š</p>

<pre><code class="language-flow">st=&gt;start: å¾…åŠ å¯†æ˜æ–‡
op0=&gt;operation: æ˜æ–‡ä¸å¯†é’¥å¼‚æˆ–è¿ç®—
op1=&gt;operation: è·å–åŠ å¯†å¯†é’¥ï¼Œè®¾ç½®å¡«å……æ–¹å¼
op2=&gt;operation: åŠ å¯†ï¼ˆä¿¡æ¯+å¯†é’¥ è§„å¾‹è¿ç®—ï¼‰
cond1=&gt;condition: å¾ªç¯äº†9æ¬¡ï¼Ÿ
op3=&gt;operation: ç¬¬åæ¬¡åŠ å¯†è¿ç®—ï¼ˆåŒºåˆ«äºå‰é¢9æ¬¡ï¼‰
op4=&gt;operation: ï¼ˆæ˜æ–‡+å¯†é’¥ï¼‰è§„å¾‹ä½è¿ç®—è°ƒæ•´
e=&gt;end: AESåŠ å¯†å¯†æ–‡

st-&gt;op0-&gt;op2-&gt;cond1
op3-&gt;e
cond1(yes)-&gt;op3
cond1(no)-&gt;op4-&gt;op2


</code></pre>

<h4 id="è§£å¯†é€†è¿ç®—">è§£å¯†ï¼ˆé€†è¿ç®—ï¼‰</h4>

<p>å› ä¸ºæ˜æ–‡åŠ å¯†10è½®æ˜¯æ ¹æ®å¯†é’¥æœ‰è§„å¾‹çš„å¤æ‚è¿ç®—ï¼Œå› æ­¤è§£å¯†å°±æ˜¯ä¸Šè¿°è¿‡ç¨‹çš„é€†è¿ç®—ï¼Œåªè¦æœ‰å¯†é’¥ï¼Œå°±èƒ½é€šè¿‡è§„å¾‹é€†è¿ç®—å¾—åˆ°æ˜æ–‡</p>

<h4 id="åŠ å¯†æ¨¡å¼">åŠ å¯†æ¨¡å¼</h4>

<blockquote>
  <p>å¯¹ç§°/<a href="https://baike.baidu.com/item/åˆ†ç»„å¯†ç ">åˆ†ç»„å¯†ç </a>ä¸€èˆ¬åˆ†ä¸ºæµåŠ å¯†(å¦‚OFBã€CFBç­‰)å’Œå—åŠ å¯†(å¦‚ECBã€CBCç­‰)ã€‚å¯¹äºæµåŠ å¯†ï¼Œéœ€è¦å°†åˆ†ç»„å¯†ç è½¬åŒ–ä¸ºæµæ¨¡å¼å·¥ä½œã€‚å¯¹äºå—åŠ å¯†(æˆ–ç§°åˆ†ç»„åŠ å¯†)ï¼Œå¦‚æœè¦åŠ å¯†è¶…è¿‡å—å¤§å°çš„æ•°æ®ï¼Œå°±éœ€è¦æ¶‰åŠå¡«å……å’Œé“¾åŠ å¯†æ¨¡å¼ã€‚</p>
</blockquote>

<h5 id="ecb">ECB</h5>

<blockquote>
  <p>ECB(Electronic Code Bookç”µå­å¯†ç æœ¬)æ¨¡å¼</p>

  <p>ECBæ¨¡å¼æ˜¯æœ€æ—©é‡‡ç”¨å’Œæœ€ç®€å•çš„æ¨¡å¼ï¼Œå®ƒå°†åŠ å¯†çš„æ•°æ®åˆ†æˆè‹¥å¹²ç»„ï¼Œæ¯ç»„çš„å¤§å°è·ŸåŠ å¯†å¯†é’¥é•¿åº¦ç›¸åŒï¼Œç„¶åæ¯ç»„éƒ½ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚</p>
</blockquote>

<h5 id="cbc">CBC</h5>

<blockquote>
  <p>CBC(Cipher Block Chainingï¼ŒåŠ å¯†å—é“¾)æ¨¡å¼</p>

  <p>è¿™ç§æ¨¡å¼æ˜¯å…ˆå°†æ˜æ–‡åˆ‡åˆ†æˆè‹¥å¹²å°æ®µï¼Œç„¶åæ¯ä¸€å°æ®µä¸åˆå§‹å—æˆ–è€…ä¸Šä¸€æ®µçš„å¯†æ–‡æ®µè¿›è¡Œå¼‚æˆ–è¿ç®—åï¼Œå†ä¸å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚</p>
</blockquote>

<h4 id="javaä½¿ç”¨aesåŠ å¯†">javaä½¿ç”¨AESåŠ å¯†</h4>

<h5 id="aescryptojava">AesCrypto.java</h5>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.emoyc.note.common.util.encryption.aes</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.KeyGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>

<span class="cm">/**
 * AESåŠ å¯†
 * @author Narule
 *
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AesCrypto</span> <span class="o">{</span>
	
	<span class="cm">/**
	 * AESåŠ å¯†æ¨¡å¼
	 */</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ECB_MODE</span> <span class="o">=</span> <span class="s">"AES/ECB/PKCS5Padding"</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CBC_MODE</span> <span class="o">=</span> <span class="s">"AES/CBC/PKCS5Padding"</span><span class="o">;</span>
	
	
	<span class="cm">/**
	 * AES ECBæ¨¡å¼åŠ å¯†
     * @param content å¾…åŠ å¯†çš„å†…å®¹ 
     * @param encryptKey åŠ å¯†å¯†é’¥ 
     * @return åŠ å¯†åçš„byte[] 
     * @throws Exception 
     */</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">aesEncryptToBytes_ECB</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">contentBytes</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">keyBytes</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>  
        <span class="nc">KeyGenerator</span> <span class="n">kgen</span> <span class="o">=</span> <span class="nc">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>  
        <span class="n">kgen</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">128</span><span class="o">);</span>  
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">ECB_MODE</span><span class="o">);</span>  
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">keyBytes</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">));</span>  
        <span class="k">return</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">contentBytes</span><span class="o">);</span>
    <span class="o">}</span> 
	
	<span class="cm">/**
	 * AES ECBæ¨¡å¼è§£å¯†
	 * @param encryptBytes å¾…è§£å¯†çš„byte[] 
     * @param decryptKey è§£å¯†å¯†é’¥ 
     * @return è§£å¯†åçš„String 
     * @throws Exception 
     */</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">aesDecryptByBytes_ECB</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptBytes</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">keyBytes</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>  
        <span class="nc">KeyGenerator</span> <span class="n">kgen</span> <span class="o">=</span> <span class="nc">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>  
        <span class="n">kgen</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">128</span><span class="o">);</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">ECB_MODE</span><span class="o">);</span>  
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">keyBytes</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">));</span>  
        <span class="k">return</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">encryptBytes</span><span class="o">);</span>
    <span class="o">}</span>  
	
    
	
	<span class="cm">/**
	 * AES CBCæ¨¡å¼åŠ å¯†
	 * @throws Exception 
	 */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">aesEncryptToBytes_CBC</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptBytes</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">ivBytes</span><span class="o">,</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">keyBytes</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">keyBytes</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">);</span>
		<span class="nc">IvParameterSpec</span> <span class="no">IV</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IvParameterSpec</span><span class="o">(</span><span class="n">ivBytes</span><span class="o">);</span>
		<span class="nc">Cipher</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">CBC_MODE</span><span class="o">);</span>
		<span class="n">c</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="no">IV</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">encryptBytes</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="cm">/**
	 * AES CBCæ¨¡å¼è§£å¯†
	 * @throws Exception 
	 */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">aesDecryptByBytes_CBC</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptBytes</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">ivBytes</span><span class="o">,</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">keyBytes</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>  
    	<span class="nc">SecretKeySpec</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">keyBytes</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">);</span>
		<span class="nc">IvParameterSpec</span> <span class="no">IV</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IvParameterSpec</span><span class="o">(</span><span class="n">ivBytes</span><span class="o">);</span>
    	<span class="nc">Cipher</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">CBC_MODE</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="no">IV</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">decryptBytes</span><span class="o">);</span> 
    <span class="o">}</span> 
    
<span class="o">}</span>

</code></pre></div></div>

<h5 id="aesutiljava">AesUtil.java</h5>

<details>
	<summary>code</summary>

```java
package com.emoyc.note.common.util.encryption.aes;


/**
 * AES åŠ å¯†æ•´åˆå·¥å…·ç±»
 * @author Narule
 *
 */
public class AesUtil {
	
	/**
	 * AESä¸´æ—¶KEY
	 */
	private static final String KEY = "jdkcnvlao903nhfl";
	
	
	/**
	 * AES-ECB åŠ å¯†æ¨¡å¼
	 * @param content //åŸæ–‡
	 * @param key
	 * @return _encrypt //å¯†æ–‡
	 * @throws Exception
	 */
	public final static String aesEncrypt_ECB(String content,String key) throws Exception {
		return base64Encode(
					AesCrypto.aesEncryptToBytes_ECB(content.getBytes(), key.getBytes())
				);
	}
	
	/**
	 * AES-ECB è§£å¯†æ¨¡å¼
	 * @param content //å¯†æ–‡
	 * @param key
	 * @return _decrypt //åŸæ–‡
	 * @throws Exception
	 */
	public final static String aesDecrypt_ECB(String content,String key) throws Exception {
		return new String(
					AesCrypto.aesDecryptByBytes_ECB(base64Decode(content), key.getBytes())
				);
	}
	
	/**
	 * AES-CBC åŠ å¯†æ¨¡å¼
	 * @param content //åŸæ–‡
	 * @param key
	 * @return _encrypt //å¯†æ–‡
	 * @throws Exception
	 */
	public final static String aesEncrypt_CBC(String content,String key) throws Exception {
		
		return base64Encode(
					AesCrypto.aesEncryptToBytes_CBC(content.getBytes(), key.getBytes(),key.getBytes())
				);
	}
	
	/**
	 * AES-CBC è§£å¯†æ¨¡å¼
	 * @param content //å¯†æ–‡
	 * @param key
	 * @return _decrypt //åŸæ–‡
	 * @throws Exception
	 */
	public final static String aesDecrypt_CBC(String content,String key) throws Exception {
		return new String(
					AesCrypto.aesDecryptByBytes_CBC(base64Decode(content), key.getBytes(), key.getBytes())
				);
	}
	
	
	 /** 
     * base 64 encode 
     * @param bytes å¾…ç¼–ç çš„byte[] 
     * @return ç¼–ç åçš„base 64 code 
     */  
    public static String base64Encode(byte[] bytes){  
    	return java.util.Base64.getEncoder().encodeToString(bytes);
    }  
  
    /** 
     * base 64 decode 
     * @param base64Code å¾…è§£ç çš„base 64 code 
     * @return è§£ç åçš„byte[] 
     * @throws Exception 
     */  
    public static byte[] base64Decode(String base64Code) throws Exception{  
    	 return (base64Code == null || base64Code.length() == 0) ? null : java.util.Base64.getDecoder().decode(base64Code);
    }
    
    
    
    
    
    
    
    
    
    
    public static void main(String[] args) {
    	String string = "å´æ¥ äºˆ";
		testAes_ECB(string);
		testAes_CBC(string);
	}

	private static void testAes_ECB(String string) {
		System.out.println("===================ECBåŠ å¯†=================");
		System.out.println("æ˜æ–‡ï¼š" );
		System.out.println(string);
		String aesEncrypt_ECB = null;
		String aesDecrypt_ECB = null;
		try {
			aesEncrypt_ECB = aesEncrypt_ECB(string, KEY);
			System.out.println("å¯†æ–‡ï¼š");
			System.out.println(aesEncrypt_ECB);
			aesDecrypt_ECB = aesDecrypt_ECB(aesEncrypt_ECB, KEY);
			System.out.println("è§£å¯†åï¼š");
			System.out.println(aesDecrypt_ECB);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	private static void testAes_CBC(String string) {
		System.out.println("===================CBCåŠ å¯†=================");
		System.out.println("æ˜æ–‡ï¼š" );
		System.out.println(string);
		String aesEncrypt_CBC = null;
		String aesDecrypt_CBC = null;
		try {
			aesEncrypt_CBC = aesEncrypt_CBC(string, KEY);
			System.out.println("å¯†æ–‡ï¼š");
			System.out.println(aesEncrypt_CBC);
			aesDecrypt_CBC = aesDecrypt_CBC(aesEncrypt_CBC, KEY);
			System.out.println("è§£å¯†åï¼š");
			System.out.println(aesDecrypt_CBC);
		} catch (Exception e) {
			e.printStackTrace();
		}
	} 
    
}
```

</details>

<h5 id="åŠ è§£å¯†test">åŠ è§£å¯†Test</h5>

<p>è¿è¡ŒAesUtilçš„mainæ–¹æ³•ï¼š</p>

<p><img src="https://img2020.cnblogs.com/blog/1436620/202005/1436620-20200522141411759-2056476981.png" alt="" /></p>

<h2 id="éå¯¹ç§°åŠ å¯†">éå¯¹ç§°åŠ å¯†</h2>

<h3 id="rsa">RSA</h3>

<blockquote>
  <p>å‚è€ƒæ–‡ç« </p>

  <p>http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html</p>

  <p>http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html</p>

  <p>https://www.jianshu.com/p/ca659dbc6f46</p>
</blockquote>

<p>é€šè¿‡ä¸Šé¢çš„æ–‡ç« è‡ªå·±å®è·µæµ‹è¯•ï¼Œæ•°å­—å°ï¼Œä½†æ˜¯ä¸å½±å“</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
p = 3 q = 5

n = 3 * 5 = 15

n' = 2 * 4 = 8

é€‰ä¸€ä¸ªæ•° e  ä¸ 8 äº’è´¨ 
e = 7

7 * x + 8 * y = 1

x = 7 = d
y = -6


åŠ å¯† 3

3^7 = 2187

2187%15  = 12

12^7%15 = 3



e = ï¼“

3 * x + 8 * y = 1

x = 11 = d
y = -4


åŠ å¯† 3

3^3 = 27

27%15  = 12

12^11%15 = 3
</code></pre></div></div>

<h4 id="javaä½¿ç”¨rsaåŠ å¯†å·¥å…·">javaä½¿ç”¨RSAåŠ å¯†å·¥å…·</h4>

<h5 id="rsautiljava">RsaUtil.java</h5>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.emoyc.note.common.util.encryption.rsa</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.ByteArrayInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyPair</span><span class="o">;</span>

<span class="cm">/**
 * RSA åŠ å¯†å·¥å…·æ•´åˆç±»
 * @author Narule
 *
 */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RsaUtil</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">publicKey</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">privateKey</span><span class="o">;</span>

	<span class="cm">/**
	 * mainæ–¹æ³• - RSA åŠ å¯†è§£å¯†æµ‹è¯•
	 * @param args
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="n">createKey</span><span class="o">();</span>
		<span class="n">initKey</span><span class="o">();</span>
		<span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"å´æ¥ äºˆ"</span><span class="o">;</span>
		<span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptData</span> <span class="o">=</span> <span class="nc">RsaCrypto</span><span class="o">.</span><span class="na">encryptData</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">publicKey</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"=========åŠ å¯†==============="</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">encryptData</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"=========è§£å¯†==============="</span><span class="o">);</span>
		<span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptData</span> <span class="o">=</span> <span class="nc">RsaCrypto</span><span class="o">.</span><span class="na">decryptData</span><span class="o">(</span><span class="n">encryptData</span><span class="o">,</span> <span class="n">privateKey</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">decryptData</span><span class="o">));</span>
	<span class="o">}</span>
	
	<span class="cm">/**
	 * createKey åˆ›å»ºRSA å¯†é’¥å¯¹
	 */</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createKey</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">try</span> <span class="o">{</span>
    		<span class="nc">KeyPair</span> <span class="n">generateKeyPair</span> <span class="o">=</span> <span class="nc">RsaCrypto</span><span class="o">.</span><span class="na">creatKey</span><span class="o">();</span>
    		<span class="n">byteToFile</span><span class="o">(</span><span class="n">generateKeyPair</span><span class="o">.</span><span class="na">getPublic</span><span class="o">().</span><span class="na">getEncoded</span><span class="o">(),</span> <span class="s">"./rsa_2048_pubkey.txt"</span><span class="o">);</span>
    		<span class="n">byteToFile</span><span class="o">(</span><span class="n">generateKeyPair</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">().</span><span class="na">getEncoded</span><span class="o">(),</span> <span class="s">"./rsa_2048_prikey.txt"</span><span class="o">);</span>
    	<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    		<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    	<span class="o">}</span>
    <span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">KeyPair</span> <span class="nf">getOneRsaKey</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">try</span> <span class="o">{</span>
    		<span class="k">return</span> <span class="nc">RsaCrypto</span><span class="o">.</span><span class="na">creatKey</span><span class="o">();</span>
    	<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    		<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    	<span class="o">}</span>
    	<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="cm">/**
	 * readKey è¯»å–å¯†é’¥æ–‡ä»¶
	 */</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initKey</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">publicKey</span> <span class="o">=</span>  <span class="n">fileToByte</span><span class="o">(</span><span class="s">"./rsa_2048_pubkey.txt"</span><span class="o">);</span>
			<span class="n">privateKey</span> <span class="o">=</span>  <span class="n">fileToByte</span><span class="o">(</span><span class="s">"./rsa_2048_prikey.txt"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
    
    
    
    <span class="cm">/**
     * byte-&gt;file äºŒè¿›åˆ¶æ•°æ®è½¬æ–‡ä»¶
     * @param bytes
     * @param filePath
     * @throws Exception
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">byteToFile</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">,</span> <span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayInputStream</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
        <span class="nc">File</span> <span class="n">destFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">destFile</span><span class="o">.</span><span class="na">getParentFile</span><span class="o">().</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">destFile</span><span class="o">.</span><span class="na">getParentFile</span><span class="o">().</span><span class="na">mkdirs</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">destFile</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>
        <span class="nc">OutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">destFile</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2048</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">nRead</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">nRead</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">cache</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">cache</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">nRead</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
    
    
    <span class="cm">/**
     * file-&gt;byte æ–‡ä»¶è½¬äºŒè¿›åˆ¶
     * @param filePath
     * @return
     * @throws Exception
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">fileToByte</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">FileInputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
            <span class="nc">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">(</span><span class="mi">2048</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2048</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">nRead</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">nRead</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">cache</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">cache</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">nRead</span><span class="o">);</span>
                <span class="n">out</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h5 id="rsacryptojava">RsaCrypto.java</h5>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.emoyc.note.common.util.encryption.rsa</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.Key</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyPair</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyPairGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.PublicKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.spec.PKCS8EncodedKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.spec.X509EncodedKeySpec</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>


<span class="cm">/**
 * RSA åŠ å¯†è§£å¯†ç±»
 * @author Narule
 *
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RsaCrypto</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ALGORITHM_RSA</span> <span class="o">=</span> <span class="s">"RSA"</span><span class="o">;</span>

	<span class="cm">/** */</span>
	<span class="cm">/**
	 * RSAæœ€å¤§åŠ å¯†æ˜æ–‡å¤§å°
	 */</span>
	<span class="c1">// 2048</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">MAX_ENCRYPT_BLOCK</span> <span class="o">=</span> <span class="mi">245</span><span class="o">;</span>

	<span class="cm">/** */</span>
	<span class="cm">/**
	 * RSAæœ€å¤§è§£å¯†å¯†æ–‡å¤§å°
	 */</span>
	<span class="c1">// 2048</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">MAX_DECRYPT_BLOCK</span> <span class="o">=</span> <span class="mi">256</span><span class="o">;</span>


	
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">KeyPair</span> <span class="nf">creatKey</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">KeyPairGenerator</span> <span class="n">keyPairGenerator</span> <span class="o">=</span> <span class="nc">KeyPairGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">ALGORITHM_RSA</span><span class="o">);</span>
		<span class="n">keyPairGenerator</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="mi">2048</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">keyPairGenerator</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>
	<span class="o">}</span>
	
	
	<span class="cm">/**
	 * RSA å…¬é’¥åŠ å¯†
	 * 
	 * @param data
	 * @param key
	 * @return
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">encryptData</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedData</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">X509EncodedKeySpec</span> <span class="n">x509KeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">X509EncodedKeySpec</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="nc">KeyFactory</span> <span class="n">keyFactory</span> <span class="o">=</span> <span class="nc">KeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">ALGORITHM_RSA</span><span class="o">);</span>
			<span class="nc">PublicKey</span> <span class="n">generatePublic</span> <span class="o">=</span> <span class="n">keyFactory</span><span class="o">.</span><span class="na">generatePublic</span><span class="o">(</span><span class="n">x509KeySpec</span><span class="o">);</span>

			<span class="c1">// å¯¹æ•°æ®åŠ å¯†</span>
			<span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">keyFactory</span><span class="o">.</span><span class="na">getAlgorithm</span><span class="o">());</span>
			<span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">generatePublic</span><span class="o">);</span>
			<span class="kt">int</span> <span class="n">inputLen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
			<span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
			<span class="kt">int</span> <span class="n">offSet</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">cache</span><span class="o">;</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="c1">// å¯¹æ•°æ®åˆ†æ®µåŠ å¯†</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span> <span class="o">&gt;</span> <span class="no">MAX_ENCRYPT_BLOCK</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">cache</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">offSet</span><span class="o">,</span> <span class="no">MAX_ENCRYPT_BLOCK</span><span class="o">);</span>
				<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
					<span class="n">cache</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">offSet</span><span class="o">,</span> <span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span><span class="o">);</span>
				<span class="o">}</span>
				<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">cache</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">cache</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
				<span class="n">i</span><span class="o">++;</span>
				<span class="n">offSet</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="no">MAX_ENCRYPT_BLOCK</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">encryptedData</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
			<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">// é˜²æ­¢æµæœªå…³é—­ æµªè´¹å ç”¨èµ„æº</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">out</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">encryptedData</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * RSA ç§é’¥è§£å¯†
	 * 
	 * @param data
	 * @param key
	 * @return
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">decryptData</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptedData</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">PKCS8EncodedKeySpec</span> <span class="n">pkcs8KeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PKCS8EncodedKeySpec</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="nc">KeyFactory</span> <span class="n">keyFactory</span> <span class="o">=</span> <span class="nc">KeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">ALGORITHM_RSA</span><span class="o">);</span>
			<span class="nc">Key</span> <span class="n">privateK</span> <span class="o">=</span> <span class="n">keyFactory</span><span class="o">.</span><span class="na">generatePrivate</span><span class="o">(</span><span class="n">pkcs8KeySpec</span><span class="o">);</span>
			<span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">keyFactory</span><span class="o">.</span><span class="na">getAlgorithm</span><span class="o">());</span>
			<span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">privateK</span><span class="o">);</span>
			<span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
			<span class="kt">int</span> <span class="n">inputLen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
			<span class="kt">int</span> <span class="n">offSet</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">cache</span><span class="o">;</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="c1">// å¯¹æ•°æ®åˆ†æ®µè§£å¯†</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span> <span class="o">&gt;</span> <span class="no">MAX_DECRYPT_BLOCK</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">cache</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">offSet</span><span class="o">,</span> <span class="no">MAX_DECRYPT_BLOCK</span><span class="o">);</span>
				<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
					<span class="n">cache</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">offSet</span><span class="o">,</span> <span class="n">inputLen</span> <span class="o">-</span> <span class="n">offSet</span><span class="o">);</span>
				<span class="o">}</span>
				<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">cache</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">cache</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
				<span class="n">i</span><span class="o">++;</span>
				<span class="n">offSet</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="no">MAX_DECRYPT_BLOCK</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">decryptedData</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
			<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">// é˜²æ­¢æµæœªå…³é—­ æµªè´¹å ç”¨èµ„æº</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">out</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">decryptedData</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<h2 id="å…¶ä»–">å…¶ä»–</h2>
:ET