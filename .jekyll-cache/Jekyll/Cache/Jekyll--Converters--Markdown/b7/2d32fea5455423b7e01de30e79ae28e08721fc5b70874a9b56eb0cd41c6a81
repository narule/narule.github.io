I"ïV<p>IOæ‘˜è¦ ~</p>

<h1 id="java-io">Java IO</h1>

<blockquote>
  <p>IO:  Input And Output</p>
</blockquote>

<p>java ä¸­æœ‰IOï¼Œå³è¾“å…¥ä¸è¾“å‡ºï¼Œ<strong>è¾“å…¥input è¾“å‡ºoutput</strong></p>

<p>java æœ‰å…¸å‹çš„IOä¸NIOï¼Œå¸¸è¯´çš„IOæŒ‡å…¸å‹IO, é˜»å¡IOï¼Œ NIOè¡¨ç¤ºéé˜»å¡IO</p>

<p>é˜»å¡ï¼š ç­‰å¾…IOä»»åŠ¡å®Œæˆæ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥çš„æ“ä½œ</p>

<p>éé˜»å¡ï¼š æš‚ä¸èƒ½æ¸…æ™°æè¿°ï¼Œå¯ä»¥æŸ¥çœ‹ç½‘å€æ–‡ç« é“¾æ¥ï¼š<a href="http://ifeve.com/overview/">http://ifeve.com/overview/</a></p>

<p>è¿™é‡Œç®€å•ä»‹ç»Javaä¸­å¸¸è§çš„æ–‡ä»¶è¯»å†™â€™â€™</p>

<p>å­—èŠ‚æµè¯»å†™æ–‡ä»¶ï¼š</p>

<h3 id="è¯»æ–‡ä»¶">è¯»æ–‡ä»¶</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">readFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">file</span><span class="o">.</span><span class="na">isFile</span><span class="o">())</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"file is not exist"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="nc">FileInputStream</span> <span class="n">fileInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span> <span class="c1">//åˆ›å»ºæ–‡ä»¶è¾“å…¥æµ</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">read</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">fileInputStream</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">read</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"read content:"</span> <span class="o">+</span> <span class="n">read</span><span class="o">);</span>
			<span class="o">}</span>
			<span class="n">fileInputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// å…³é—­æµ é‡Šæ”¾èµ„æº</span>
		<span class="o">}</span>

	<span class="o">}</span>
</code></pre></div></div>

<h3 id="å†™æ–‡ä»¶">å†™æ–‡ä»¶</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">writeFile</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">content</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\Jser\\data\\test\\writeFile.xml"</span><span class="o">);</span> <span class="c1">//è·å–å†™æ–‡ä»¶çš„ä½ç½®</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span>
			<span class="n">file</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>
		<span class="nc">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span> <span class="c1">//åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµ</span>
		<span class="n">fileOutputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">content</span><span class="o">);</span> <span class="c1">// content è¡¨ç¤ºå†™å…¥æ–‡ä»¶çš„å†…å®¹ </span>
		<span class="n">fileOutputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>	<span class="c1">//å…³é—­æµ é‡Šæ”¾èµ„æº</span>
	<span class="o">}</span>
</code></pre></div></div>

<h3 id="æ‹·è´æ–‡ä»¶">æ‹·è´æ–‡ä»¶</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.RandomAccessFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.ByteBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.FileChannel</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestIO</span> <span class="o">{</span>
    
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">originFilePath</span> <span class="o">=</span> <span class="s">"D:\\Jser\\data\\git-rep\\jdp\\note\\Program-StudyPlan.md"</span><span class="o">;</span>
		<span class="nc">String</span> <span class="n">aimFilePath</span> <span class="o">=</span> <span class="s">"D:\\Jser\\data\\test\\aimFile.md"</span><span class="o">;</span>
		<span class="n">copyFile</span><span class="o">(</span><span class="n">originFilePath</span><span class="o">,</span> <span class="n">aimFilePath</span><span class="o">);</span>
<span class="c1">//		testRandonAccessFile();</span>
	<span class="o">}</span>    
	
	<span class="cm">/*
	 * è¯»æ–‡ä»¶
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">readFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">file</span><span class="o">.</span><span class="na">isFile</span><span class="o">())</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"file is not exist"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="nc">FileInputStream</span> <span class="n">fileInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">read</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">fileInputStream</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">read</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"read content:"</span> <span class="o">+</span> <span class="n">read</span><span class="o">);</span>
			<span class="o">}</span>
			<span class="n">fileInputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>

	<span class="o">}</span>
	
	<span class="cm">/**
	 * å†™æ–‡ä»¶
	 * @throws IOException
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">writeFile</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">content</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\Jser\\data\\test\\writeFile.xml"</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span>
			<span class="n">file</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>
		<span class="nc">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
		<span class="n">fileOutputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
		<span class="n">fileOutputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
    
	<span class="cm">/*
	 * æ–‡ä»¶å¤åˆ¶ -&gt; è¯»å–ä¸€ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">copyFile</span><span class="o">(</span><span class="nc">String</span> <span class="n">originFilePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">aimPath</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">File</span> <span class="n">originFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">originFilePath</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">originFile</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"file is not exists!"</span><span class="o">);</span>
			<span class="k">return</span><span class="o">;</span>   <span class="c1">//æ–‡ä»¶ä¸å­˜åœ¨</span>
		<span class="o">}</span>
		<span class="nc">File</span> <span class="n">aimFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">aimPath</span><span class="o">);</span>
		<span class="nc">FileInputStream</span> <span class="n">fi</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="nc">FileOutputStream</span> <span class="n">fo</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>   <span class="c1">//æ¯æ¬¡è¯»æ–‡ä»¶å†…å®¹çš„å­—èŠ‚æ•°ç»„</span>
			<span class="k">if</span> <span class="o">(!</span><span class="n">aimFile</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span>
				<span class="n">aimFile</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>
            <span class="c1">// é€šè¿‡è·¯å¾„è½¬åŒ–ä¸º è¾“å…¥æµ å’Œ è¾“å‡ºæµ</span>
			<span class="n">fi</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">originFile</span><span class="o">);</span>  <span class="c1">//è¾“å…¥æµ</span>
			<span class="n">fo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">aimFile</span><span class="o">);</span>	<span class="c1">//è¾“å‡ºæµ</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">fi</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">content</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//è¾“å…¥æµå°†æ•°æ®è¯»å–åˆ°å­—èŠ‚æ•°ç»„ï¼Œå¦‚æœè¿”å›å€¼ä¸º -1 è¡¨ç¤ºæ–‡ä»¶å·²ç»è¯»å®Œ</span>
				<span class="n">fo</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">content</span><span class="o">);</span> <span class="c1">//è¾“å‡ºæµå°†æ•°ç»„å†…å®¹å†™å…¥æ–‡ä»¶</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"read file exception!"</span><span class="o">);</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="c1">// close resources;</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">fo</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
					<span class="n">fo</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">fi</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
					<span class="n">fi</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">es</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// TODO Auto-generated catch block</span>
				<span class="n">es</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">fo</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
					<span class="n">fo</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">fi</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
					<span class="n">fi</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// TODO Auto-generated catch block</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
    
    <span class="cm">/*
    * java æ¶‰åŠNIOçš„ RandomAccessFile ç±»
    */</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testRandonAccessFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">RandomAccessFile</span> <span class="n">aFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomAccessFile</span><span class="o">(</span><span class="s">"D:\\Jser\\data\\git-rep\\config\\maven\\settings.xml"</span><span class="o">,</span> <span class="s">"rw"</span><span class="o">);</span>
		<span class="nc">FileChannel</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">aFile</span><span class="o">.</span><span class="na">getChannel</span><span class="o">();</span>
		<span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\Jser\\data\\test\\creatFile.xml"</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">getParentFile</span><span class="o">().</span><span class="na">exists</span><span class="o">())</span>
			<span class="n">file</span><span class="o">.</span><span class="na">getParentFile</span><span class="o">().</span><span class="na">mkdirs</span><span class="o">();</span>

		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">isFile</span><span class="o">())</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"file is not exist!"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span>
			<span class="n">file</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>

		<span class="nc">FileOutputStream</span> <span class="n">newFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
		<span class="nc">ByteBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="nc">ByteBuffer</span><span class="o">.</span><span class="na">allocate</span><span class="o">(</span><span class="mi">1024</span><span class="o">);</span>
		<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
		<span class="k">while</span> <span class="o">(</span><span class="n">channel</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">i</span><span class="o">++;</span>
			<span class="n">buffer</span><span class="o">.</span><span class="na">flip</span><span class="o">();</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">hasRemaining</span><span class="o">())</span> <span class="o">{</span>
				<span class="n">newFile</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
			<span class="o">}</span>
			<span class="n">buffer</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="n">aFile</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="n">newFile</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ–‡ä»¶è¯»å–æ¬¡æ•°ï¼š"</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

:ET